syntax = "proto3";

package auth.v1;

import "buf/validate/validate.proto";

option go_package = "github.com/samarthasthan/services-commons/gen/go/auth/v1;authv1";

message GenerateTokenRequest {
  int64 user_id = 1 [(buf.validate.field).int64.gte = 1];
  string external_id = 2 [(buf.validate.field).string.min_len = 1];
  string email = 3 [(buf.validate.field).string.min_len = 1];
  string role = 4 [(buf.validate.field).string.min_len = 1];;
}

message GenerateTokenResponse {
  string access_token = 1;
  string refresh_token = 2;
}

message ValidateTokenRequest {}

message ValidateTokenResponse {
  int64 user_id = 1 [(buf.validate.field).int64.gte = 1];
  string external_id = 2 [(buf.validate.field).string.min_len = 1];
  string email = 3 [(buf.validate.field).string.min_len = 1];
  string role = 4 [(buf.validate.field).string.min_len = 1];
  bool is_valid = 5;
}

message RefreshTokenRequest {}

message RefreshTokenResponse {
  string access_token = 1;
  string refresh_token = 2;
}

message DeleteTokensRequest {}

message DeleteTokensResponse {}

message RevokeTokenRequest {}

message RevokeTokenResponse {}

service AuthService {
  rpc GenerateToken(GenerateTokenRequest) returns (GenerateTokenResponse);
  rpc ValidateToken(ValidateTokenRequest) returns (ValidateTokenResponse);
  rpc RefreshToken(RefreshTokenRequest) returns (RefreshTokenResponse);
  rpc DeleteTokens(DeleteTokensRequest) returns (DeleteTokensResponse);
  rpc RevokeToken(RevokeTokenRequest) returns (RevokeTokenResponse);
}
